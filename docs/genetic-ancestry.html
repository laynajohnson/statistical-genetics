<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 2 Genetic Ancestry | Statistical Genetics Content Summary</title>
  <meta name="description" content=" 2 Genetic Ancestry | Statistical Genetics Content Summary" />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content=" 2 Genetic Ancestry | Statistical Genetics Content Summary" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 2 Genetic Ancestry | Statistical Genetics Content Summary" />
  
  
  

<meta name="author" content="Alayna Johnson" />


<meta name="date" content="2025-03-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="genome-wide-association-studies-gwas.html"/>
<link rel="next" href="last-unit.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Content Summary</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="1" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html"><i class="fa fa-check"></i><b>1</b> Genome-Wide Association Studies (GWAS)</a>
<ul>
<li class="chapter" data-level="1.1" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#introduction-to-gwas"><i class="fa fa-check"></i><b>1.1</b> Introduction to GWAS</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#genome-breakdown"><i class="fa fa-check"></i><b>1.1.1</b> Genome Breakdown</a></li>
<li class="chapter" data-level="1.1.2" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#a-small-example"><i class="fa fa-check"></i><b>1.1.2</b> A small example</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#simulating-a-gwas"><i class="fa fa-check"></i><b>1.2</b> Simulating a GWAS</a></li>
<li class="chapter" data-level="1.3" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#marginal-regression"><i class="fa fa-check"></i><b>1.3</b> Marginal Regression</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#multiple-testing"><i class="fa fa-check"></i><b>1.3.1</b> Multiple testing</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#visualizing-gwas"><i class="fa fa-check"></i><b>1.4</b> Visualizing GWAS</a></li>
<li class="chapter" data-level="" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#wrapping-up"><i class="fa fa-check"></i>Wrapping up</a></li>
<li class="chapter" data-level="" data-path="genome-wide-association-studies-gwas.html"><a href="genome-wide-association-studies-gwas.html#glossary"><i class="fa fa-check"></i>Glossary</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html"><i class="fa fa-check"></i><b>2</b> Genetic Ancestry</a>
<ul>
<li class="chapter" data-level="2.1" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#describing-human-populations"><i class="fa fa-check"></i><b>2.1</b> Describing Human Populations</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#population-admixture"><i class="fa fa-check"></i><b>2.1.1</b> Population Admixture</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#principal-component-analysis"><i class="fa fa-check"></i><b>2.2</b> Principal Component Analysis</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#genetic-data-pca"><i class="fa fa-check"></i><b>2.2.1</b> Genetic Data PCA</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#confounding-variables"><i class="fa fa-check"></i><b>2.3</b> Confounding Variables</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#omitted-variable-bias"><i class="fa fa-check"></i><b>2.3.1</b> Omitted Variable Bias</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="genetic-ancestry.html"><a href="genetic-ancestry.html#glossary-1"><i class="fa fa-check"></i>Glossary</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="last-unit.html"><a href="last-unit.html"><i class="fa fa-check"></i><b>3</b> Last Unit</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Genetics Content Summary</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="genetic-ancestry" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number"> 2</span> Genetic Ancestry<a href="genetic-ancestry.html#genetic-ancestry" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>What is ancestry, and what can genetic data tell us about it? There are several ways that one can think about genetic ancestry. In these chapters, we will consider genetic ancestry to loosely mean the genetic relationship between you and your ancestors.</p>
<p>An important idea to remember throughout this chapter is <em>genetic similarity</em>. If you have ever taken a genetic test through a company like 23andMe or Ancestry.com you are most likely familiar with this concept. When you take one of these tests by sending in some of your DNA, these companies are reporting back to you how similar your DNA is compared to different populations.</p>
<p>The concept of different populations comes up a lot in these contexts. As with all scientific research, there are some ethical issues surrounding how researchers classify populations in genetic studies. We will get into this next.</p>
<p><br />
</p>
<div id="describing-human-populations" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Describing Human Populations<a href="genetic-ancestry.html#describing-human-populations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>When a researcher is working with genetic data, they will likely use some sort of population descriptor to attempt to capture complex differences in human genetics.</p>
<p>When you look at the results of your personal DNA test, you will likely see your ancestry broken down into smaller percentages of regions or peoples that contribute to 100% you. The way these regions are described brings with it some questions you may have never thought of before:</p>
<ul>
<li><p><em>How are regions defined? Are political borders used in every case?</em></p></li>
<li><p><em>What is the genetic “line” between being reported as native to one area versus another geography close by? How specific can this get?</em></p></li>
</ul>
<p>So, what are the recommended ways to describe human populations?</p>
<hr />
<ol style="list-style-type: decimal">
<li><p>To start, you should never use race as a descriptor of genetic variation. Race is a concept created by white people in the past to other different peoples. There is no reason to use these arbitrary descriptors in a genetic study.</p></li>
<li><p>Different populations do not exist as discrete genetic clusters, but instead as a continuum across space and time. Assigning constricting labels to different populations can be harmful, especially if you are not conscious of potential impacts of your chosen terminology.</p>
<ol style="list-style-type: lower-alpha">
<li>Think about if there are different ways to classify populations related environmental factors rather than the people themselves. Genetic similarity, geography, and indigeneity are some top choices provided by the National Academies of Sciences.</li>
</ol></li>
<li><p>Explaining the choices for using specific terminology to describe human populations.</p>
<ol style="list-style-type: lower-alpha">
<li>Being aware of cultures and incorporating their thoughts into your choices. Maybe you also need multiple labels, but it is important to remain consistent.</li>
</ol></li>
<li><p>Do your research on what the current recommendations are for the type of genetic study you are performing and what different institutions and organizations encourage. These can change with time, so make sure to check with any and every study.</p></li>
</ol>
<hr />
<p><br />
</p>
<div id="population-admixture" class="section level3 hasAnchor" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Population Admixture<a href="genetic-ancestry.html#population-admixture" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As our world has become so interconnected between geographies and people’s from long ago to the present, many of us have DNA inherited from multiple populations. The general term for this is <em>population admixture</em>.</p>
<p>There is not really any population that is completely homogeneous. Populations in the Americas tend to be more admixed due to history of world discovery, slavery, and immigration as compared to other continents. In the United States especially, there are many more people with ancestors all over the world. That is not to say the Americas are the only place with admixed populations. Those with European ancestry, for example, can be more similar to each other than to individuals with ancestry from a different geographical/continental area, but there are still admixed populations here when we focus our scale to Europe only.</p>
<p>When doing genetic research, you should keep this concept in mind as you collect, process, and report your data. Think about how ancestry is related to your study and which ones you are including to help guide your naming conventions and disclaimers on population differences. One way to go about this is to think of social classifications of population and trying to break those down. What would that look like?</p>
<p><br />
</p>
<div id="ancestry-in-genetics-studies" class="section level4 unnumbered hasAnchor">
<h4>Ancestry in Genetics Studies<a href="genetic-ancestry.html#ancestry-in-genetics-studies" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>When we conduct a genetic study, we want to be aware of the ancestry of our samples. Things like genetic similarity and continental geography come to mind. It is important to correct for these population structures built into our data so we can have the most accurate results.</p>
<p>One method we can use to account for population structures in genetic data is by performing <em>Principal Component Analysis</em>. We can also use PCA on admixed ancestry. We will go into what PCA is and how to apply it to genetic data next.</p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="principal-component-analysis" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Principal Component Analysis<a href="genetic-ancestry.html#principal-component-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>If you have taken a class in linear algebra or machine learning, you may be familiar with the method of Principal Component Analysis (PCA). We use PCA as a technique to reduce the dimensionality of correlated variables while keeping as much variation as possible. We will be left with principal components (PC’s) as weighted combinations of these variables that explain the most variation in our data. Essentially, instead of having thousands of SNPs representing genetic variation, this method will represent genetic variation in fewer dimensions made up of the original data.</p>
<p>The first few PC’s explain the most variation in our data. Here is an example of what the PC’s we create from this method could look like:</p>
<p><span class="math display">\[\begin{align}
\text{PC}1 &amp;= a{11}x_1 + a_{12}x_2 + \dots + a_{1p}x_p \\
\text{PC}2 &amp;= a{21}x_1 + a_{22}x_2 + \dots + a_{2p}x_p \\
&amp;\vdots \\
\text{PC}n &amp;= a{n1}x_1 + a_{n2}x_2 + \dots + a_{np}x_p
\end{align}\]</span></p>
<p>where</p>
<p><span class="math display">\[\begin{align}
&amp; x_1, x_2, \dots, x_p \text{ are the original SNPs and} \\
&amp; a_{ij} \text{ are the weights of each SNP towards a PC}
\end{align}\]</span></p>
<p>The <span class="math inline">\(a_n\)</span> values represent the weights of each SNP that goes into each principal component. We call these the <em>loadings</em>. They are essentially telling you how important each SNP is to the PC.</p>
<p>The <span class="math inline">\(a_N\)</span> values combined with the <span class="math inline">\(x_1, x2, \dots\)</span> values create our PCs, and these values we call the <em>scores</em>.</p>
<p><br />
</p>
<div id="genetic-data-pca" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Genetic Data PCA<a href="genetic-ancestry.html#genetic-data-pca" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can use PCA with genetic data in order to correct for stratification from things like population (which is what we will be looking at with an example below). Say there is some set of SNPs that have very different <em>MAF</em> between populations. These features are most likely correlated to each other and stratify the data by representing the difference between populations and will contribute most to the top PCs.</p>
<p>Let’s simulate some genetic data to run PCA on and break down some of the concepts briefly mentioned above. We will use some similar simulation code to the last chapter on GWAS.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="genetic-ancestry.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="genetic-ancestry.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-3"><a href="genetic-ancestry.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(GGally)</span></code></pre></div>
<p><em>Simulating data</em></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="genetic-ancestry.html#cb2-1" tabindex="-1"></a><span class="co"># simulate a genetic variant with freq. depending on which population the person belongs to</span></span>
<span id="cb2-2"><a href="genetic-ancestry.html#cb2-2" tabindex="-1"></a>sim_data_onevar <span class="ot">&lt;-</span> <span class="cf">function</span>(pop, maf){</span>
<span id="cb2-3"><a href="genetic-ancestry.html#cb2-3" tabindex="-1"></a>  snp <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> <span class="fu">length</span>(pop), <span class="at">size =</span> <span class="dv">2</span>, <span class="at">p =</span> maf[pop])</span>
<span id="cb2-4"><a href="genetic-ancestry.html#cb2-4" tabindex="-1"></a>  <span class="fu">return</span>(snp)</span>
<span id="cb2-5"><a href="genetic-ancestry.html#cb2-5" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="genetic-ancestry.html#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="genetic-ancestry.html#cb2-7" tabindex="-1"></a><span class="co"># create dataset with two types of SNPs</span></span>
<span id="cb2-8"><a href="genetic-ancestry.html#cb2-8" tabindex="-1"></a>popidx <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each =</span> <span class="dv">400</span>)</span>
<span id="cb2-9"><a href="genetic-ancestry.html#cb2-9" tabindex="-1"></a>maf1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>) <span class="co"># type 1: non-existent in pop 1, frequent in pop2</span></span>
<span id="cb2-10"><a href="genetic-ancestry.html#cb2-10" tabindex="-1"></a>maf2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">0.2</span>) <span class="co"># type 2: higher frequency in pop 1 and lower in pop 2</span></span>
<span id="cb2-11"><a href="genetic-ancestry.html#cb2-11" tabindex="-1"></a>maf3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.32</span>) <span class="co"># type 3: similar freq in pops 1 and 2</span></span>
<span id="cb2-12"><a href="genetic-ancestry.html#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="genetic-ancestry.html#cb2-13" tabindex="-1"></a></span>
<span id="cb2-14"><a href="genetic-ancestry.html#cb2-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">494</span>)</span>
<span id="cb2-15"><a href="genetic-ancestry.html#cb2-15" tabindex="-1"></a>snps1 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">3</span>, <span class="fu">sim_data_onevar</span>(<span class="at">pop =</span> popidx, <span class="at">maf =</span> maf1)) <span class="co"># create 3 (independent) snps of type 1</span></span>
<span id="cb2-16"><a href="genetic-ancestry.html#cb2-16" tabindex="-1"></a>snps2 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1</span>, <span class="fu">sim_data_onevar</span>(<span class="at">pop =</span> popidx, <span class="at">maf =</span> maf2)) <span class="co"># create 1 (independent) snp of type 2</span></span>
<span id="cb2-17"><a href="genetic-ancestry.html#cb2-17" tabindex="-1"></a>snps3 <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">16</span>, <span class="fu">sim_data_onevar</span>(<span class="at">pop =</span> popidx, <span class="at">maf =</span> maf3)) <span class="co"># create 15 (independent) snps of type 3</span></span>
<span id="cb2-18"><a href="genetic-ancestry.html#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="genetic-ancestry.html#cb2-19" tabindex="-1"></a>pcadata <span class="ot">&lt;-</span> <span class="fu">cbind</span>(popidx, snps1, snps2, snps3) <span class="sc">%&gt;%</span></span>
<span id="cb2-20"><a href="genetic-ancestry.html#cb2-20" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()</span>
<span id="cb2-21"><a href="genetic-ancestry.html#cb2-21" tabindex="-1"></a><span class="fu">names</span>(pcadata) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;population&#39;</span>, <span class="fu">paste0</span>(<span class="st">&#39;SNP&#39;</span>, <span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(pcadata)<span class="sc">-</span><span class="dv">1</span>)))</span>
<span id="cb2-22"><a href="genetic-ancestry.html#cb2-22" tabindex="-1"></a></span>
<span id="cb2-23"><a href="genetic-ancestry.html#cb2-23" tabindex="-1"></a><span class="co"># simulating a trait on snp 4 in our data</span></span>
<span id="cb2-24"><a href="genetic-ancestry.html#cb2-24" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">800</span> <span class="co"># number of individuals </span></span>
<span id="cb2-25"><a href="genetic-ancestry.html#cb2-25" tabindex="-1"></a>trait <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> pcadata[,<span class="st">&#39;SNP4&#39;</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># y = 2 * x + e</span></span>
<span id="cb2-26"><a href="genetic-ancestry.html#cb2-26" tabindex="-1"></a></span>
<span id="cb2-27"><a href="genetic-ancestry.html#cb2-27" tabindex="-1"></a>trait <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(trait) </span>
<span id="cb2-28"><a href="genetic-ancestry.html#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="genetic-ancestry.html#cb2-29" tabindex="-1"></a><span class="co"># joining snps and trait</span></span>
<span id="cb2-30"><a href="genetic-ancestry.html#cb2-30" tabindex="-1"></a>pcadata <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">cbind</span>(trait, pcadata))</span></code></pre></div>
<p>Calculating the MAF for each SNP in our data summarized by population. We create a function that will add the minor alleles and divide by 2x the number of people we have in the data.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="genetic-ancestry.html#cb3-1" tabindex="-1"></a>get_MAF <span class="ot">&lt;-</span> <span class="cf">function</span>(snp){</span>
<span id="cb3-2"><a href="genetic-ancestry.html#cb3-2" tabindex="-1"></a>  <span class="fu">sum</span>(snp)<span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span><span class="fu">length</span>(snp))</span>
<span id="cb3-3"><a href="genetic-ancestry.html#cb3-3" tabindex="-1"></a>}</span>
<span id="cb3-4"><a href="genetic-ancestry.html#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="genetic-ancestry.html#cb3-5" tabindex="-1"></a><span class="co"># get observed allele frequency for each population</span></span>
<span id="cb3-6"><a href="genetic-ancestry.html#cb3-6" tabindex="-1"></a>pcadata <span class="sc">%&gt;%</span></span>
<span id="cb3-7"><a href="genetic-ancestry.html#cb3-7" tabindex="-1"></a>  <span class="fu">group_by</span>(population) <span class="sc">%&gt;%</span></span>
<span id="cb3-8"><a href="genetic-ancestry.html#cb3-8" tabindex="-1"></a>  <span class="fu">summarize_all</span>(get_MAF)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 22
##   population trait  SNP1  SNP2  SNP3  SNP4  SNP5  SNP6  SNP7  SNP8  SNP9 SNP10
##        &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1          1 1.20  0     0     0     0.599 0.295 0.326 0.34  0.275 0.284 0.3  
## 2          2 0.380 0.811 0.785 0.821 0.196 0.316 0.308 0.316 0.302 0.312 0.316
## # ℹ 10 more variables: SNP11 &lt;dbl&gt;, SNP12 &lt;dbl&gt;, SNP13 &lt;dbl&gt;, SNP14 &lt;dbl&gt;,
## #   SNP15 &lt;dbl&gt;, SNP16 &lt;dbl&gt;, SNP17 &lt;dbl&gt;, SNP18 &lt;dbl&gt;, SNP19 &lt;dbl&gt;,
## #   SNP20 &lt;dbl&gt;</code></pre>
<p>In order to run PCA, we need to have only the genotype information from our data. This means removing the <code>population</code> and <code>trait</code> variables. Then we will perform PCA on our remaining data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="genetic-ancestry.html#cb5-1" tabindex="-1"></a>genotype <span class="ot">&lt;-</span> pcadata <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="genetic-ancestry.html#cb5-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>population, <span class="sc">-</span>trait)</span>
<span id="cb5-3"><a href="genetic-ancestry.html#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="genetic-ancestry.html#cb5-4" tabindex="-1"></a><span class="co"># performing pca</span></span>
<span id="cb5-5"><a href="genetic-ancestry.html#cb5-5" tabindex="-1"></a>pca_out <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(genotype, <span class="at">center =</span> <span class="cn">TRUE</span>, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="genetic-ancestry.html#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="genetic-ancestry.html#cb5-7" tabindex="-1"></a><span class="co"># storing loadings and scores from pca</span></span>
<span id="cb5-8"><a href="genetic-ancestry.html#cb5-8" tabindex="-1"></a>pca_loadings <span class="ot">&lt;-</span> pca_out<span class="sc">$</span>rotation</span>
<span id="cb5-9"><a href="genetic-ancestry.html#cb5-9" tabindex="-1"></a>pca_scores <span class="ot">&lt;-</span> pca_out<span class="sc">$</span>x</span></code></pre></div>
<p><br />
</p>
<div id="visualizing-pca" class="section level4 unnumbered hasAnchor">
<h4>Visualizing PCA<a href="genetic-ancestry.html#visualizing-pca" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s take a look at what the components of our PCs look like.</p>
<p><em>Score Plot</em></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="genetic-ancestry.html#cb6-1" tabindex="-1"></a>pca_scores <span class="sc">%&gt;%</span></span>
<span id="cb6-2"><a href="genetic-ancestry.html#cb6-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> <span class="co"># convert pca_scores into a data frame for plotting</span></span>
<span id="cb6-3"><a href="genetic-ancestry.html#cb6-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population =</span> <span class="fu">as.factor</span>(pcadata<span class="sc">$</span>population)) <span class="sc">%&gt;%</span>  <span class="co"># add the population labels</span></span>
<span id="cb6-4"><a href="genetic-ancestry.html#cb6-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> PC1, <span class="at">y =</span> PC2, <span class="at">color =</span> population)) <span class="sc">+</span> <span class="co"># then plot</span></span>
<span id="cb6-5"><a href="genetic-ancestry.html#cb6-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb6-6"><a href="genetic-ancestry.html#cb6-6" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Dark2&#39;</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="genetic-ancestry.html#cb6-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/score-plot-1.png" width="672" /></p>
<p>The scores above represent the new values for the individuals in our study along the PC1 and PC2 axes. In our plot, we colored the points by population. Before we performed PCA, we took out our population variable, yet this graph shows how our data is still separated into two populations through this method.</p>
<p>We can also use a kind of visualization called parallel coordinates plot. This plot is another way to view how the PCs capture our populations by showing the scores for all PCs at one time. As we learned from our score plot, we see PC1 and PC2 capture population membership, while later PCs do not.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="genetic-ancestry.html#cb7-1" tabindex="-1"></a><span class="co"># parallel coordinates plot</span></span>
<span id="cb7-2"><a href="genetic-ancestry.html#cb7-2" tabindex="-1"></a>pca_scores <span class="sc">%&gt;%</span></span>
<span id="cb7-3"><a href="genetic-ancestry.html#cb7-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="genetic-ancestry.html#cb7-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">population =</span> <span class="fu">as.factor</span>(pcadata<span class="sc">$</span>population)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-5"><a href="genetic-ancestry.html#cb7-5" tabindex="-1"></a>  <span class="fu">ggparcoord</span>(<span class="at">columns =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, <span class="at">groupColumn =</span> <span class="st">&#39;population&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb7-6"><a href="genetic-ancestry.html#cb7-6" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb7-7"><a href="genetic-ancestry.html#cb7-7" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Dark2&#39;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/parallel-coords-plot-1.png" width="672" /></p>
<p>Remembering from before, <em>loadings</em> show us how much each SNP contributes to a PC. We can view this PC by PC. We will look at plots for for PC1 to PC4.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="genetic-ancestry.html#cb8-1" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb8-2"><a href="genetic-ancestry.html#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="genetic-ancestry.html#cb8-3" tabindex="-1"></a>pca_loadings[, <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">%&gt;%</span></span>
<span id="cb8-4"><a href="genetic-ancestry.html#cb8-4" tabindex="-1"></a>  <span class="fu">melt</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="genetic-ancestry.html#cb8-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> value, <span class="at">fill =</span> Var1)) <span class="sc">+</span></span>
<span id="cb8-6"><a href="genetic-ancestry.html#cb8-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-7"><a href="genetic-ancestry.html#cb8-7" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> Var2) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="genetic-ancestry.html#cb8-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;loadings&quot;</span>, <span class="at">x =</span> <span class="st">&quot;original features&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;original features&quot;</span>) <span class="sc">+</span></span>
<span id="cb8-9"><a href="genetic-ancestry.html#cb8-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb8-10"><a href="genetic-ancestry.html#cb8-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x=</span><span class="fu">element_blank</span>(), <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/loadings-plot-1.png" width="672" /></p>
<p><br />
<br />
</p>
</div>
</div>
</div>
<div id="confounding-variables" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Confounding Variables<a href="genetic-ancestry.html#confounding-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="omitted-variable-bias" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> Omitted Variable Bias<a href="genetic-ancestry.html#omitted-variable-bias" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><br />
</p>
</div>
</div>
<div id="glossary-1" class="section level2 unnumbered hasAnchor">
<h2>Glossary<a href="genetic-ancestry.html#glossary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Terms for this chapter and beyond.</p>
<ul>
<li><p><u><em>Pedigree</em></u>: how genealogical ancestors are related to each other, like an extensive family tree</p></li>
<li><p><u><em>Genealogical ancestry</em></u>: the identifiable ancestors in your pedigree</p></li>
<li><p><u><em>Genetic ancestry</em></u>: the paths through one’s pedigree by which genetic traits have been inherited</p></li>
<li><p><u><em>Genetic similarity</em></u>: classifying genomes as similar to specific populations</p>
<ul>
<li><u><em>Population admixture</em></u>: the mating of individuals with different geographical/continental origins</li>
</ul></li>
<li><p><u><em>Principal Component Analysis</em></u>: a method of dimension reduction to keep the most variation from our original data by weighting the variables togehter into new components (PCs).</p>
<ul>
<li><p><u><em>Loading</em></u>: How much of each SNP contributes to a particular PC, the weights.</p></li>
<li><p><u><em>Score</em></u>: the transformed values for individuals along the new PC axes.</p></li>
</ul></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="genome-wide-association-studies-gwas.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="last-unit.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/laynajohnson/statistical-genetics/edit/main/02-unit2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/laynajohnson/statistical-genetics/blob/main/02-unit2.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"sharing": {
"linkedin": true
},
"search": true,
"search_options": {
"placeholder": "Search book..."
}
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
